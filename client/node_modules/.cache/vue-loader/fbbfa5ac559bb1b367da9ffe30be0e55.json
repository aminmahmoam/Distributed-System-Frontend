{"remainingRequest":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/aminmahmoudi/Desktop/DIT356/client 2/client/src/views/Account.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/src/views/Account.vue","mtime":1671800748225},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtcXR0IGZyb20gJy4uL01RVFQnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQWNjb3VudCcsCiAgcHJvcHM6IFsnQWNjb3VudCddLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlZGl0ZWRVc2VyOiAnJywKICAgICAgZWRpdERldGFpbHM6IGZhbHNlLAogICAgICBoYXNBY2NvdW50OiBmYWxzZSwKICAgICAgZmlyc3ROYW1lOiAnJywKICAgICAgbGFzdE5hbWU6ICcnLAogICAgICBlbWFpbEFkZHJlc3M6ICcnLAogICAgICBwYXNzd29yZDogJycKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldEluZm8oKQoKICB9LAogIG1ldGhvZHM6IHsKICAgIHBhcnNlSnd0KHRva2VuKSB7CiAgICAgIGNvbnN0IGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV0KICAgICAgY29uc3QgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJykKICAgICAgY29uc3QganNvblBheWxvYWQgPSBkZWNvZGVVUklDb21wb25lbnQod2luZG93LmF0b2IoYmFzZTY0KS5zcGxpdCgnJykubWFwKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuICclJyArICgnMDAnICsgYy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpCiAgICAgIH0pLmpvaW4oJycpKQogICAgICBsZXQgdXNlciA9IEpTT04ucGFyc2UoanNvblBheWxvYWQpCiAgICAgIHJldHVybiB1c2VyCgogICAgfSwKICAgIHNhdmUoKSB7CgogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBmaXJzdE5hbWU6IHRoaXMuZmlyc3ROYW1lLAogICAgICAgIGxhc3ROYW1lOiB0aGlzLmxhc3ROYW1lLAogICAgICAgIGVtYWlsQWRkcmVzczogIHRoaXMuZW1haWxBZGRyZXNzLAogICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkLAogICAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9naW5Ub2tlbicpCiAgICAgIH0KICAgICAgbGV0IHVzZXIgPSB0aGlzLnBhcnNlSnd0KGxvY2FsU3RvcmFnZS5sb2dpblRva2VuKQogICAgICBsZXQgcmVzdWx0ID0gbXF0dCgncGF0Y2hVJywgYC91c2Vycy8ke3VzZXIuX2lkfWAsIGRhdGEsIGZhbHNlKQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBpZiAocmVzdWx0WzBdLmRhdGEgPT09ICc0MDEgdW5hdXRob3JpemVkJykgewogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdsb2dpblRva2VuJykKICAgICAgfSBlbHNlIGlmIChyZXN1bHRbMF0uZGF0YS5maXJzdE5hbWUpewogICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWxlcnQoJ1NvbWV0aGluZyB3ZW50IHdyb25nISBQbGFlc2UgdHJ5IGFnYWluIGxhdGVyLicpCiAgICAgIH0KICAgICAgIAogICAgICB9LCAxMDAwKQogICAgfSwKCiAgICBnZXRJbmZvKCkgewogICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICB0b2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2luVG9rZW4nKQogICAgICAgIH0KICAgICAgICBsZXQgdXNlciA9IHRoaXMucGFyc2VKd3QobG9jYWxTdG9yYWdlLmxvZ2luVG9rZW4pCiAgICAgICAgbGV0IHJlc3VsdCA9IG1xdHQoJ2dldFUnLCBgL3VzZXJzLyR7dXNlci5faWR9YCwgZGF0YSwgZmFsc2UpCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmIChyZXN1bHRbMF0uZGF0YSA9PT0gJzQwMSB1bmF1dGhvcml6ZWQnKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2xvZ2luVG9rZW4nKQogICAgICAgIAogICAgICB9IGVsc2UgaWYgKHJlc3VsdFswXS5kYXRhLnVzZXIpewogICAgICAgIHRoaXMuZmlyc3ROYW1lID0gcmVzdWx0WzBdLmRhdGEudXNlci5maXJzdE5hbWUKICAgICAgICB0aGlzLmxhc3ROYW1lID0gcmVzdWx0WzBdLmRhdGEudXNlci5sYXN0TmFtZQogICAgICAgIHRoaXMuZW1haWxBZGRyZXNzID0gcmVzdWx0WzBdLmRhdGEudXNlci5lbWFpbEFkZHJlc3MKICAgICAgICB0aGlzLnBhc3N3b3JkID0gcmVzdWx0WzBdLmRhdGEudXNlci5wYXNzd29yZAogICAgICB9IGVsc2UgewogICAgICAgIGFsZXJ0KCdTb21ldGhpbmcgd2VudCB3cm9uZyEgUGxhZXNlIHRyeSBhZ2FpbiBsYXRlci4nKQogICAgICB9CiAgICAgIH0sIDEwMDApCiAgICB9CiAgfQp9Cgo="},{"version":3,"sources":["Account.vue"],"names":[],"mappings":";AAkFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Account.vue","sourceRoot":"src/views","sourcesContent":["<template>\n<div>\n  <!-- Title -->\n    <div class=\"map-body\">\n    <p style=\"color: #748FC4; font-style: bold;\" class=\"map-text\">ACCOUNT DETAILS</p>\n  </div>\n    <!-- Accoutn details box -->\n    <div class=\"box\">\n        <b-row style=\"font-size: 17px;\">\n            <b-col style=\"text-align: left\">\n            <div style=\"margin-bottom: 12px;\">\n                <h>First name</h>\n            </div>\n            <div style=\"margin-bottom: 12px;\">\n                <h>Last Name</h>\n            </div>\n            <div style=\"margin-bottom: 12px;\">\n                <h>Email</h>\n            </div>\n            <div style=\"margin-bottom: 12px;\">\n                <h>Password</h>\n            </div>\n            </b-col>\n            <b-col style=\"text-align: center;\">\n                <div style=\"margin-bottom: 12px;\">\n                    <h>:</h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>:</h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>:</h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>:</h>\n                </div>\n            </b-col>\n            <b-col style=\"text-align: left\" v-if=\"editDetails === false\">\n                <div style=\"margin-bottom: 12px;\">\n                    <h>{{firstName}}</h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>{{lastName}}</h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>\n                        {{emailAddress}}\n                    </h>\n                </div>\n                <div style=\"margin-bottom: 12px;\">\n                    <h>******</h>\n                </div>\n            </b-col>\n\n            <!-- Edit account details -->\n            <b-col style=\"text-align: left;  font-size: 17px;\" v-if=\"editDetails === true\">\n                <div style=\"margin-bottom: 5px;\">\n                    <input style=\"width: 300px;\" placeholder=\"First Name\" v-model=\"firstName\">\n                </div>\n                <div style=\"margin-bottom: 5px;\">\n                    <input style=\"width: 300px;\" placeholder=\"Last Name\" v-model=\"lastName\">\n                </div>\n                <div style=\"margin-bottom: 5px;\">\n                    <input style=\"width: 300px;\" placeholder=\"Email\" v-model=\"emailAddress\">\n                </div>\n                <div style=\"margin-bottom: 5px;\">\n                    <input style=\"width: 300px;\" placeholder=\"Password\" >\n                </div>\n                <div style=\"margin-bottom: 5px;\">\n                    <input style=\"width: 300px;\" placeholder=\"Repeat password\">\n                </div>\n            </b-col>\n        </b-row>\n        <!-- Buttons -->\n        <div v-if=\"editDetails === false\" class=\"edit-button\" style=\"color: #748FC4\" v-on:click=\"editDetails = true\"><h class=\"edit-text\">Edit Details</h></div>\n        <div v-if=\"editDetails === true\" class=\"cancel-button\" style=\"color: #748FC4; margin-right: 5px;\" v-on:click=\"editDetails = false\"><h class=\"edit-text\">Cancel</h></div>\n        <div v-if=\"editDetails === true\" class=\"edit-button\" style=\"color: #748FC4\" v-on:click=\"editDetails = false\"><h class=\"edit-text\" @click=\"save()\">Save</h></div>\n    </div>\n</div>\n</template>\n\n<script>\nimport mqtt from '../MQTT'\nexport default {\n  name: 'Account',\n  props: ['Account'],\n  data() {\n    return {\n      editedUser: '',\n      editDetails: false,\n      hasAccount: false,\n      firstName: '',\n      lastName: '',\n      emailAddress: '',\n      password: ''\n    }\n  },\n  mounted() {\n    this.getInfo()\n\n  },\n  methods: {\n    parseJwt(token) {\n      const base64Url = token.split('.')[1]\n      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/')\n      const jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function (c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)\n      }).join(''))\n      let user = JSON.parse(jsonPayload)\n      return user\n\n    },\n    save() {\n\n      let data = {\n        firstName: this.firstName,\n        lastName: this.lastName,\n        emailAddress:  this.emailAddress,\n        password: this.password,\n        token: localStorage.getItem('loginToken')\n      }\n      let user = this.parseJwt(localStorage.loginToken)\n      let result = mqtt('patchU', `/users/${user._id}`, data, false)\n      setTimeout(() => {\n        if (result[0].data === '401 unauthorized') {\n        localStorage.removeItem('loginToken')\n      } else if (result[0].data.firstName){\n         console.log(result)\n      } else {\n        alert('Something went wrong! Plaese try again later.')\n      }\n       \n      }, 1000)\n    },\n\n    getInfo() {\n        let data = {\n            token: localStorage.getItem('loginToken')\n        }\n        let user = this.parseJwt(localStorage.loginToken)\n        let result = mqtt('getU', `/users/${user._id}`, data, false)\n      setTimeout(() => {\n        if (result[0].data === '401 unauthorized') {\n        localStorage.removeItem('loginToken')\n        \n      } else if (result[0].data.user){\n        this.firstName = result[0].data.user.firstName\n        this.lastName = result[0].data.user.lastName\n        this.emailAddress = result[0].data.user.emailAddress\n        this.password = result[0].data.user.password\n      } else {\n        alert('Something went wrong! Plaese try again later.')\n      }\n      }, 1000)\n    }\n  }\n}\n\n</script>\n\n<style>\n.box {\n    margin-top: 3rem;\n    box-sizing: border-box;\n    height: auto;\n    border-radius: 25px;\n    text-align: center;\n    margin-left: 18%;\n    margin-right: 18%;\n    background: #ffffff;\n    padding: 40px;\n    color: #748FC4;\n    box-shadow: 4px 10px 10px rgba(143, 145, 190, 0.25);\n}\n.edit-button {\n    padding: 10px;\n    display:inline-block;\n    text-align: center;\n    margin-top: 1rem;\n    box-sizing: border-box;\n    height: auto;\n    background-color: #748FC4;\n    color: #ffffff;\n    border-radius: 25px;\n    cursor: pointer;\n    border: 2px solid #748FC4;\n    box-shadow: 0px 4px 4px rgba(143, 145, 190, 0.25);\n}\n.edit-text {\n    color: #ffffff;\n}\n.edit-button:hover {\n    background-color: #4E6289;\n    border: 2px solid #4E6289;\n}\n.cancel-button {\n    padding: 10px;\n    display:inline-block;\n    text-align: center;\n    margin-top: 1rem;\n    box-sizing: border-box;\n    height: auto;\n    background-color: #748FC4;\n    color: #ffffff;\n    border-radius: 25px;\n    cursor: pointer;\n    border: 2px solid #748FC4;\n    box-shadow: 0px 4px 4px rgba(143, 145, 190, 0.25);\n}\n.cancel-button:hover {\n    background-color: #DD7676;\n    border: 2px solid #DD7676;\n}\n</style>\n"]}]}