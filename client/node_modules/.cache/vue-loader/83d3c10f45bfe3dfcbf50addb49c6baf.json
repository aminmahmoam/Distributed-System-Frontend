{"remainingRequest":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/aminmahmoudi/Desktop/DIT356/client 2/client/src/views/Bookings.vue?vue&type=style&index=0&id=b3cf2f18&lang=css&","dependencies":[{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/src/views/Bookings.vue","mtime":1671800748226},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1655715156000},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/aminmahmoudi/Desktop/DIT356/client 2/client/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiNib29raW5ncy1ib3ggewogICAgbWFyZ2luLXRvcDogM3JlbTsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICBoZWlnaHQ6IGF1dG87CiAgICBib3JkZXItcmFkaXVzOiAyNXB4OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgbWFyZ2luLWxlZnQ6IDE4JTsKICAgIG1hcmdpbi1yaWdodDogMTglOwogICAgYmFja2dyb3VuZDogI2ZmZmZmZjsKICAgIHBhZGRpbmc6IDQwcHg7CiAgICBjb2xvcjogIzc0OEZDNDsKICAgIGJveC1zaGFkb3c6IDBweCA0cHggNHB4IHJnYmEoMTQzLCAxNDUsIDE5MCwgMC4yNSk7CiAgICBwYWRkaW5nOiAyMHB4Owp9Ci5ib29rLWJveCB7CiAgICBoZWlnaHQ6IGF1dG87CiAgICBtYXJnaW4tdG9wOiAxNXB4OwogICAgcGFkZGluZy10b3A6IDExcHg7CiAgICBjb2xvcjojNzQ4RkM0OwogICAgYmFja2dyb3VuZDogI0YwRjVGRjsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHggMTBweCAxMHB4IDEwcHg7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgYm94LXNoYWRvdzogMHB4IDRweCA0cHggcmdiYSgxNDMsIDE0NSwgMTkwLCAwLjI1KTsKICAgIHBhZGRpbmctYm90dG9tOiAzcHg7CiAgICBtYXJnaW4tbGVmdDogMSU7CiAgICBtYXJnaW4tcmlnaHQ6IDElOwp9Cg=="},{"version":3,"sources":["Bookings.vue"],"names":[],"mappings":";AAkGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Bookings.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <!-- Booking history -->\n    <div>\n        <div class=\"map-body\">\n    <p style=\"color: #748FC4; font-style: bold;\" class=\"map-text\">MY BOOKINGS</p>\n  </div>\n    <div id=\"bookings-box\">\n        <div style=\"text-align: center; width: 100%;\" v-for=\"booking in bookings\" v-bind:key=\"booking\">\n          <div class=\"book-box\">\n          <b-row>\n            <b-col>\n                <h>Date: {{booking.date.substr(0,10)}}</h>\n            </b-col>\n            <b-col>\n                <h>Time: {{booking.time}}</h>\n            </b-col>\n            <b-col>\n                <h>Clinic: {{booking.clinicName}}</h>\n            </b-col>\n            <b-col>\n                <h>Dentist: Dentist{{booking.dentistId}}</h>\n            </b-col>\n        </b-row>\n          </div>\n\n        </div>\n    </div>\n</div>\n</template>\n\n<script>\nimport book from '../components/Book.vue'\nimport mqtt from '../MQTT'\nexport default {\n  components: { book },\n  data() {\n    return {\n      message: 'none',\n      bookings: [],\n      newBooking: ''\n    }\n  },\n  mounted() {\n    this.getAllBookings()\n  },\n  methods: {\n    parseJwt(token) {\n      const base64Url = token.split('.')[1]\n      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/')\n      const jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function (c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)\n      }).join(''))\n      let user = JSON.parse(jsonPayload)\n      return user\n\n    },\n    getAllBookings() {\n      let user = this.parseJwt(localStorage.loginToken)\n      let data = {\n        token: localStorage.getItem('loginToken')\n      }\n      let result = mqtt('get', `/users/${user._id}/bookings`, data, false)\n      setTimeout(() => {\n        if (result[0].data === '401 unauthorized') {\n        localStorage.removeItem('loginToken')\n      } else if (result[0].data.bookings) {\n        this.bookings = result[0].data.bookings\n      } else {\n        alert('Something went wrong! Plaese try again later.')\n      }\n        \n      }, 1000)\n    },\n    // This method is only for the sake of saving a booking for a user and test if it is stored in the database\n    // This method should propably be in the Bookins.vue pages\n    addBooking() {\n      setTimeout(() => {\n        this.newBooking = {\n          userId: 12,\n          reuestId: 1,\n          dentistId: 1,\n          issuance: 1,\n          date: '2022-10-11'\n        }\n      }, 1000)\n      const result = mqtt('postBookingForUser', '/users/6391edbcdce1167c194f2e35/bookings', this.newBooking, true)\n      if (result.status === 201) {\n        console.log('succesfull')\n      } else {\n        console.log('unsuccsesfull')\n      }\n    }\n    \n  }\n}\n</script>\n\n<style>\n#bookings-box {\n    margin-top: 3rem;\n    box-sizing: border-box;\n    height: auto;\n    border-radius: 25px;\n    text-align: center;\n    margin-left: 18%;\n    margin-right: 18%;\n    background: #ffffff;\n    padding: 40px;\n    color: #748FC4;\n    box-shadow: 0px 4px 4px rgba(143, 145, 190, 0.25);\n    padding: 20px;\n}\n.book-box {\n    height: auto;\n    margin-top: 15px;\n    padding-top: 11px;\n    color:#748FC4;\n    background: #F0F5FF;\n    border-radius: 10px 10px 10px 10px;\n    box-sizing: border-box;\n    box-shadow: 0px 4px 4px rgba(143, 145, 190, 0.25);\n    padding-bottom: 3px;\n    margin-left: 1%;\n    margin-right: 1%;\n}\n</style>\n"]}]}